<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pydgn.training &mdash; PyDGN 1.0.4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="callback.early_stopping" href="pydgn.training.callback.html" />
    <link rel="prev" title="readout.graph_readout" href="pydgn.model.readout.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyDGN
            <img src="../_static/pydgn-logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Intro and Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pydgn.data.html">pydgn.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.evaluation.html">pydgn.evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.experiment.html">pydgn.experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.log.html">pydgn.log</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.model.html">pydgn.model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">pydgn.training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#training-callback">training.callback</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html">callback.early_stopping</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.engine_callback">callback.engine_callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.gradient_clipping">callback.gradient_clipping</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.metric">callback.metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.optimizer">callback.optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.plotter">callback.plotter</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.scheduler">callback.scheduler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#training-event">training.event</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.event.html">event.dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.event.html#module-pydgn.training.event.handler">event.handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydgn.training.event.html#module-pydgn.training.event.state">event.state</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pydgn.training.engine">training.engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pydgn.training.profiler">training.profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pydgn.training.util">training.util</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyDGN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>pydgn.training</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/pydgn.training.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pydgn-training">
<h1>pydgn.training<a class="headerlink" href="#pydgn-training" title="Permalink to this headline"></a></h1>
<section id="training-callback">
<h2>training.callback<a class="headerlink" href="#training-callback" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html">callback.early_stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.engine_callback">callback.engine_callback</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.gradient_clipping">callback.gradient_clipping</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.metric">callback.metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.optimizer">callback.optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.plotter">callback.plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.callback.html#module-pydgn.training.callback.scheduler">callback.scheduler</a></li>
</ul>
</div>
</section>
<section id="training-event">
<h2>training.event<a class="headerlink" href="#training-event" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.event.html">event.dispatcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.event.html#module-pydgn.training.event.handler">event.handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydgn.training.event.html#module-pydgn.training.event.state">event.state</a></li>
</ul>
</div>
</section>
<section id="module-pydgn.training.engine">
<span id="training-engine"></span><h2>training.engine<a class="headerlink" href="#module-pydgn.training.engine" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pydgn.training.engine.LinkPredictionSingleGraphEngine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pydgn.training.engine.</span></span><span class="sig-name descname"><span class="pre">LinkPredictionSingleGraphEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine_callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.engine_callback.EngineCallback" title="pydgn.training.callback.engine_callback.EngineCallback"><span class="pre">pydgn.training.callback.engine_callback.EngineCallback</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.model.html#pydgn.model.interface.ModelInterface" title="pydgn.model.interface.ModelInterface"><span class="pre">pydgn.model.interface.ModelInterface</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.metric.Metric" title="pydgn.training.callback.metric.Metric"><span class="pre">pydgn.training.callback.metric.Metric</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.optimizer.Optimizer" title="pydgn.training.callback.optimizer.Optimizer"><span class="pre">pydgn.training.callback.optimizer.Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.metric.Metric" title="pydgn.training.callback.metric.Metric"><span class="pre">pydgn.training.callback.metric.Metric</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.scheduler.Scheduler" title="pydgn.training.callback.scheduler.Scheduler"><span class="pre">pydgn.training.callback.scheduler.Scheduler</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.early_stopping.EarlyStopper" title="pydgn.training.callback.early_stopping.EarlyStopper"><span class="pre">pydgn.training.callback.early_stopping.EarlyStopper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clipper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.gradient_clipping.GradientClipper" title="pydgn.training.callback.gradient_clipping.GradientClipper"><span class="pre">pydgn.training.callback.gradient_clipping.GradientClipper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.plotter.Plotter" title="pydgn.training.callback.plotter.Plotter"><span class="pre">pydgn.training.callback.plotter.Plotter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_last_checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.engine.LinkPredictionSingleGraphEngine" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pydgn.training.engine.TrainingEngine" title="pydgn.training.engine.TrainingEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydgn.training.engine.TrainingEngine</span></code></a></p>
<p>Specific engine for link prediction tasks. Here, we expect target values in the form of tuples: <code class="docutils literal notranslate"><span class="pre">(_,</span> <span class="pre">pos_edges,</span> <span class="pre">neg_edges)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">pos_edges</span></code> and <code class="docutils literal notranslate"><span class="pre">neg_edges</span></code> have been generated by the splitter and provided by the data provider.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pydgn.training.engine.TrainingEngine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pydgn.training.engine.</span></span><span class="sig-name descname"><span class="pre">TrainingEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine_callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.engine_callback.EngineCallback" title="pydgn.training.callback.engine_callback.EngineCallback"><span class="pre">pydgn.training.callback.engine_callback.EngineCallback</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.model.html#pydgn.model.interface.ModelInterface" title="pydgn.model.interface.ModelInterface"><span class="pre">pydgn.model.interface.ModelInterface</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.metric.Metric" title="pydgn.training.callback.metric.Metric"><span class="pre">pydgn.training.callback.metric.Metric</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.optimizer.Optimizer" title="pydgn.training.callback.optimizer.Optimizer"><span class="pre">pydgn.training.callback.optimizer.Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.metric.Metric" title="pydgn.training.callback.metric.Metric"><span class="pre">pydgn.training.callback.metric.Metric</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.scheduler.Scheduler" title="pydgn.training.callback.scheduler.Scheduler"><span class="pre">pydgn.training.callback.scheduler.Scheduler</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.early_stopping.EarlyStopper" title="pydgn.training.callback.early_stopping.EarlyStopper"><span class="pre">pydgn.training.callback.early_stopping.EarlyStopper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clipper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.gradient_clipping.GradientClipper" title="pydgn.training.callback.gradient_clipping.GradientClipper"><span class="pre">pydgn.training.callback.gradient_clipping.GradientClipper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.plotter.Plotter" title="pydgn.training.callback.plotter.Plotter"><span class="pre">pydgn.training.callback.plotter.Plotter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_last_checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.engine.TrainingEngine" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pydgn.training.event.html#pydgn.training.event.dispatcher.EventDispatcher" title="pydgn.training.event.dispatcher.EventDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydgn.training.event.dispatcher.EventDispatcher</span></code></a></p>
<p>This is the most important class when it comes to training a model. It implements the <a class="reference internal" href="pydgn.training.event.html#pydgn.training.event.dispatcher.EventDispatcher" title="pydgn.training.event.dispatcher.EventDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventDispatcher</span></code></a> interface,
which means that after registering some callbacks in a given order, it will proceed to trigger specific events that
will result in the shared <a class="reference internal" href="pydgn.training.event.html#pydgn.training.event.state.State" title="pydgn.training.event.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object being updated by the callbacks. Callbacks implement the EventHandler
interface, and they receive the shared State object when any event is triggered. Knowing the order in which
callbacks are called is important.
The order is:</p>
<ul class="simple">
<li><p>loss function</p></li>
<li><p>score function</p></li>
<li><p>gradient clipper</p></li>
<li><p>optimizer</p></li>
<li><p>early stopper</p></li>
<li><p>scheduler</p></li>
<li><p>plotter</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine_callback</strong> (Callable[…, <a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.engine_callback.EngineCallback" title="pydgn.training.callback.engine_callback.EngineCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">EngineCallback</span></code></a>]) – the engine callback object to be used for data fetching and checkpoints (or even other purposes if necessary)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="pydgn.model.html#pydgn.model.interface.ModelInterface" title="pydgn.model.interface.ModelInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelInterface</span></code></a>) – the model to be trained</p></li>
<li><p><strong>loss</strong> (<a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.metric.Metric" title="pydgn.training.callback.metric.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>) – the loss to be used</p></li>
<li><p><strong>optimizer</strong> (<a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.optimizer.Optimizer" title="pydgn.training.callback.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a>) – the optimizer to be used</p></li>
<li><p><strong>scorer</strong> (<a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.metric.Metric" title="pydgn.training.callback.metric.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>) – the score to be used</p></li>
<li><p><strong>scheduler</strong> (<a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.scheduler.Scheduler" title="pydgn.training.callback.scheduler.Scheduler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scheduler</span></code></a>) – the scheduler to be used Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>early_stopper</strong> (<a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.early_stopping.EarlyStopper" title="pydgn.training.callback.early_stopping.EarlyStopper"><code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStopper</span></code></a>) – the early stopper to be used. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>gradient_clipper</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">GradientClipper</span></code>) – the gradient clipper to be used. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – the device on which to train. Default is <code class="docutils literal notranslate"><span class="pre">cpu</span></code>.</p></li>
<li><p><strong>plotter</strong> (<a class="reference internal" href="pydgn.training.callback.html#pydgn.training.callback.plotter.Plotter" title="pydgn.training.callback.plotter.Plotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code></a>) – the plotter to be used. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>exp_path</strong> (<em>str</em>) – the path of the experiment folder. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> but it is always instantiated.</p></li>
<li><p><strong>evaluate_every</strong> (<em>int</em>) – the frequency of logging epoch results. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>store_last_checkpoint</strong> (<em>bool</em>) – whether to store a checkpoint at the end of each epoch. Allows to resume training from last epoch. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pydgn.training.engine.TrainingEngine.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch_geometric.loader.dataloader.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch_geometric.data.data.Data</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#pydgn.training.engine.TrainingEngine.infer" title="Permalink to this definition"></a></dt>
<dd><p>Performs an evaluation step on the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.loader.DataLoader</span></code>) – the loader to be used</p></li>
<li><p><strong>set</strong> (<em>str</em>) – the type of dataset being used, can be <code class="docutils literal notranslate"><span class="pre">TRAINING</span></code>, <code class="docutils literal notranslate"><span class="pre">VALIDATION</span></code> or <code class="docutils literal notranslate"><span class="pre">TEST</span></code> (as defined in <code class="docutils literal notranslate"><span class="pre">pydgn.static</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple (loss dict, score dict, list of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> objects with <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> attributes only).
The data list can be used, for instance, in semi-supervised experiments or in incremental architectures</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydgn.training.engine.TrainingEngine.set_device">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.engine.TrainingEngine.set_device" title="Permalink to this definition"></a></dt>
<dd><p>Moves the model and the loss metric to the proper device.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydgn.training.engine.TrainingEngine.set_eval_mode">
<span class="sig-name descname"><span class="pre">set_eval_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.engine.TrainingEngine.set_eval_mode" title="Permalink to this definition"></a></dt>
<dd><p>Sets the model and the internal state in <code class="docutils literal notranslate"><span class="pre">EVALUATION</span></code> mode</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydgn.training.engine.TrainingEngine.set_training_mode">
<span class="sig-name descname"><span class="pre">set_training_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.engine.TrainingEngine.set_training_mode" title="Permalink to this definition"></a></dt>
<dd><p>Sets the model and the internal state in <code class="docutils literal notranslate"><span class="pre">TRAINING</span></code> mode</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydgn.training.engine.TrainingEngine.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch_geometric.loader.dataloader.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch_geometric.loader.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch_geometric.loader.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pydgn.log.html#pydgn.log.logger.Logger" title="pydgn.log.logger.Logger"><span class="pre">pydgn.log.logger.Logger</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch_geometric.data.data.Data</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch_geometric.data.data.Data</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch_geometric.data.data.Data</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#pydgn.training.engine.TrainingEngine.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the model and regularly evaluates on validation and test data (if given).
May perform early stopping and checkpointing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.loader.DataLoader</span></code>) – the DataLoader associated with training data</p></li>
<li><p><strong>validation_loader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.loader.DataLoader</span></code>) – the DataLoader associated with validation data, if any</p></li>
<li><p><strong>test_loader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.loader.DataLoader</span></code>) – the DataLoader associated with test data, if any</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – maximum number of training epochs. Default is <code class="docutils literal notranslate"><span class="pre">100</span></code></p></li>
<li><p><strong>zero_epoch</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, starts again from epoch 0 and resets optimizer and scheduler states. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>logger</strong> – the logger</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple (train_loss, train_score, train_embeddings, validation_loss, validation_score, validation_embeddings, test_loss, test_score, test_embeddings)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pydgn.training.engine.log">
<span class="sig-prename descclassname"><span class="pre">pydgn.training.engine.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pydgn.log.html#pydgn.log.logger.Logger" title="pydgn.log.logger.Logger"><span class="pre">pydgn.log.logger.Logger</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.engine.log" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pydgn.training.profiler">
<span id="training-profiler"></span><h2>training.profiler<a class="headerlink" href="#module-pydgn.training.profiler" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pydgn.training.profiler.Profiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pydgn.training.profiler.</span></span><span class="sig-name descname"><span class="pre">Profiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.profiler.Profiler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A decorator class that is applied to a <a class="reference internal" href="pydgn.training.event.html#pydgn.training.event.handler.EventHandler" title="pydgn.training.event.handler.EventHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventHandler</span></code></a> object implementing a
set of callback functions. For each callback, the Profiler stores the average and total running time across epochs.
When the experiment terminates (either correctly or abruptly) the Profiler can produce a report to be stored in the
experiment’s log file.</p>
<p>The Profiler is used as a singleton, and it produces wrappers that update its own state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>threshold</strong> (<em>float</em>) – used to filter out callback functions that consume a negligible amount of time from the report</p>
</dd>
</dl>
<dl class="simple">
<dt>Usage:</dt><dd><p>Istantiate a profiler, and then register an event_handler with the syntax profiler(event_handler), which returns
another object implementing the <a class="reference internal" href="pydgn.training.event.html#pydgn.training.event.handler.EventHandler" title="pydgn.training.event.handler.EventHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventHandler</span></code></a> interface</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pydgn.training.profiler.Profiler.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#pydgn.training.profiler.Profiler.report" title="Permalink to this definition"></a></dt>
<dd><p>Builds a report string containing the statistics of the experiment accumulated so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a string containing the report</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pydgn.training.util">
<span id="training-util"></span><h2>training.util<a class="headerlink" href="#module-pydgn.training.util" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pydgn.training.util.atomic_save">
<span class="sig-prename descclassname"><span class="pre">pydgn.training.util.</span></span><span class="sig-name descname"><span class="pre">atomic_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pydgn.training.util.atomic_save" title="Permalink to this definition"></a></dt>
<dd><p>Atomically stores a dictionary that can be serialized by <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.save()</span></code>,
exploiting the atomic <code class="xref py py-func docutils literal notranslate"><span class="pre">os.replace()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict</em>) – the dictionary to be stored</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – the absolute filepath where to store the dictionary</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pydgn.model.readout.html" class="btn btn-neutral float-left" title="readout.graph_readout" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pydgn.training.callback.html" class="btn btn-neutral float-right" title="callback.early_stopping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Federico Errica.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>